---
title: "paper2"
description: |
  Reproducing graphs
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(here)
library(janitor)
library(patchwork)
library(ggplot2)
```

The goal is to reproduce the values and formatting of this graph.
```{r out.width = "50%"}
knitr::include_graphics(here::here("img","paper2graph.png"))
```

## read in data and clean the names
```{r}
trust <- read_csv(here("research_data", "trust.csv")) %>%
  clean_names()
```
## show names
```{r}
names(trust)
```
## convert response values to percentages (as per Table 3)
```{r}
trust %>%
  tabyl(experiment, response) %>%
  adorn_percentages()
```

## mutate dataset to add new variable "agegroup" with two possible values representing the two age groups
```{r}
trust <- trust %>%
  mutate(agegroup = case_when(age_group_participants == 0 ~ "3-5 year olds", 
                              age_group_participants == 1 ~ "5-6 year olds"),
         condition = case_when(condition_information == 0 ~ "Inaccurate-Information Condition",
                               condition_information == 1 ~ "Accurate-Information Condition"))
```

## creating the graph using ggplot
```{r}
trust %>%
  ggplot(aes(x = agegroup, y = response, fill = condition)) +
  geom_bar(position = "dodge", stat = "identity") +
  theme_bw()
```

## mutate dataset to add new variable "proportion"
```{r}
trust <- trust %>%
  mutate(proportion = group_by(agegroup)) %>% 
           summarise(n = n()) %>%
           mutate (freq = n / sum(n))
```

## create a new dataset with proportions of responses
```{r}
ptrust <- trust %>%
  group_by(agegroup) %>%
  summarise(n = n()) %>%
  mutate(freq = n / sum(n))
```

## create a new dataset with agegroup & condition variables gathered into one column
```{r}
trust2 <- trust %>%
  gather("condition", "proportion", -agegroup)
```

## create a graph using the new dataset
```{r}
ptrust %>%
  ggplot(aes(x = agegroup, y = freq)) + 
  geom_col()
```

